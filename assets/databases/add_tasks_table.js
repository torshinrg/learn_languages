// File: add_tasks_table.js

const sqlite3 = require('sqlite3').verbose();
const path = require('path');
const { v4: uuidv4 } = require('uuid'); // for unique task IDs

// Adjust this path if your DB is elsewhere
const DB_PATH = path.join(__dirname, 'spanish_app.db');

function clearTasksTable(db) {
  return new Promise((resolve, reject) => {
    db.run('DELETE FROM tasks;', (err) => {
      if (err) return reject(err);
      console.log('üßπ Cleared existing tasks from "tasks" table');
      resolve();
    });
  });
}


function createTasksTable(db) {
  return new Promise((resolve, reject) => {
    const createSQL = `
      CREATE TABLE IF NOT EXISTS tasks (
        id TEXT PRIMARY KEY,
        description TEXT NOT NULL,
        locale TEXT NOT NULL,
        task_type TEXT NOT NULL
        
      );
    `;
    db.run(createSQL, (err) => {
      if (err) return reject(err);
      console.log('‚úÖ Created (or verified) table "tasks"');
      resolve();
    });
  });
}

function insertTasks(db) {
  return new Promise((resolve, reject) => {


    const tasks = [
          {
            id: uuidv4(),
            description: 'Finish this sentence logically, using the model sentence as context.',
            locale: 'en',
            task_type: 'sentence',
          },
          {
            id: uuidv4(),
            description: 'Paraphrase the given sentence in your own words.',
            locale: 'en',
            task_type: 'sentence',
          },
          {
            id: uuidv4(),
            description: 'Ask a follow-up question based on the content of the sentence.',
            locale: 'en',
            task_type: 'sentence',
          },
          {
            id: uuidv4(),
            description: 'Answer your own question related to the sentence‚Äôs context.',
            locale: 'en',
            task_type: 'sentence',
          },
          {
            id: uuidv4(),
            description: 'Transform the sentence into its negative form.',
            locale: 'en',
            task_type: 'sentence',
          },
          {
            id: uuidv4(),
            description: 'Change the tense of the sentence (e.g., present ‚Üí future).',
            locale: 'en',
            task_type: 'sentence',
          },
          {
            id: uuidv4(),
            description: 'Convert the statement into a yes/no or wh-question.',
            locale: 'en',
            task_type: 'sentence',
          },
          {
            id: uuidv4(),
            description: 'Summarize the meaning of the sentence in one shorter sentence.',
            locale: 'en',
            task_type: 'sentence',
          },
          {
            id: uuidv4(),
            description: 'Expand the sentence by adding two extra details (time, place, or reason).',
            locale: 'en',
            task_type: 'sentence',
          },
          {
            id: uuidv4(),
            description: 'Create a contrasting sentence using ‚Äúbut‚Äù or ‚Äúhowever‚Äù.',
            locale: 'en',
            task_type: 'sentence',
          },
          {
            id: uuidv4(),
            description: 'List three synonyms or collocates related to the key word in the sentence.',
            locale: 'en',
            task_type: 'sentence',
          },
          {
            id: uuidv4(),
            description: 'Write a follow-up sentence that logically continues the scenario.',
            locale: 'en',
            task_type: 'sentence',
          },
          {
            id: uuidv4(),
            description: 'Explain the meaning of one word from the sentence in a 15-second mini-lesson.',
            locale: 'en',
            task_type: 'sentence',
          },
          {
            id: uuidv4(),
            description: 'Pose three rapid-fire interview questions someone might ask after hearing the sentence.',
            locale: 'en',
            task_type: 'sentence',
          },
            {
              id: uuidv4(),
              description: 'Pose a brief question that frames the target word (‚ÄúWhat‚Äôs your favorite [word] activity?‚Äù).',
              locale: 'en',
              task_type: 'word',
            },
            {
              id: uuidv4(),
              description: 'State a prompt involving the word (e.g., ‚ÄúIs it better to [word] alone or in a group?‚Äù).',
              locale: 'en',
              task_type: 'word',
            },
            {
              id: uuidv4(),
              description: 'List three common collocates (words that often pair) for today‚Äôs word.',
              locale: 'en',
              task_type: 'word',
            },
            {
              id: uuidv4(),
              description: 'User pretends to teach the word to a friend: records a 20-second mini-lesson defining the word, giving an example, and pronouncing it.',
              locale: 'en',
              task_type: 'word',
            },
            {
              id: uuidv4(),
              description: 'At day‚Äôs end, prompt ‚ÄúHow did you use today‚Äôs word outside the app?‚Äù User records a 60-second personal reflection, cementing real-world relevance.',
              locale: 'en',
              task_type: 'word',
            },
            {
                id: uuidv4(),
                description: '–ó–∞–≤–µ—Ä—à–∏—Ç–µ —ç—Ç–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ª–æ–≥–∏—á–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É—è –º–æ–¥–µ–ª—å–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.',
                locale: 'ru',
                task_type: 'sentence',
              },
              {
                id: uuidv4(),
                description: '–ü–µ—Ä–µ—Ñ—Ä–∞–∑–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Å–≤–æ–∏–º–∏ —Å–ª–æ–≤–∞–º–∏.',
                locale: 'ru',
                task_type: 'sentence',
              },
              {
                id: uuidv4(),
                description: '–ó–∞–¥–∞–π—Ç–µ —É—Ç–æ—á–Ω—è—é—â–∏–π –≤–æ–ø—Ä–æ—Å, –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è.',
                locale: 'ru',
                task_type: 'sentence',
              },
              {
                id: uuidv4(),
                description: '–û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–æ–ø—Ä–æ—Å, —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è.',
                locale: 'ru',
                task_type: 'sentence',
              },
              {
                id: uuidv4(),
                description: '–ü—Ä–µ–æ–±—Ä–∞–∑—É–π—Ç–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –≤ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—É—é —Ñ–æ—Ä–º—É.',
                locale: 'ru',
                task_type: 'sentence',
              },
              {
                id: uuidv4(),
                description: '–ò–∑–º–µ–Ω–∏—Ç–µ –≤—Ä–µ–º—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞—Å—Ç–æ—è—â–µ–µ ‚Üí –±—É–¥—É—â–µ–µ).',
                locale: 'ru',
                task_type: 'sentence',
              },
              {
                id: uuidv4(),
                description: '–ü—Ä–µ–æ–±—Ä–∞–∑—É–π—Ç–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤ –≤–æ–ø—Ä–æ—Å —Ç–∏–ø–∞ ¬´–¥–∞/–Ω–µ—Ç¬ª –∏–ª–∏ –≤–æ–ø—Ä–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ —Å–ª–æ–≤–æ.',
                locale: 'ru',
                task_type: 'sentence',
              },
              {
                id: uuidv4(),
                description: '–°–æ–∫—Ä–∞—Ç–∏—Ç–µ —Å–º—ã—Å–ª –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, –∏–∑–ª–æ–∂–∏–≤ –µ–≥–æ –≤ –æ–¥–Ω–æ–º –±–æ–ª–µ–µ –∫–æ—Ä–æ—Ç–∫–æ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏.',
                locale: 'ru',
                task_type: 'sentence',
              },
              {
                id: uuidv4(),
                description: '–†–∞—Å—à–∏—Ä—å—Ç–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ, –¥–æ–±–∞–≤–∏–≤ –¥–≤–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏ (–≤—Ä–µ–º—è, –º–µ—Å—Ç–æ –∏–ª–∏ –ø—Ä–∏—á–∏–Ω—É).',
                locale: 'ru',
                task_type: 'sentence',
              },
              {
                id: uuidv4(),
                description: '–°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ—Å—Ç–∞–≤–ª—è—é—â–µ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ, –∏—Å–ø–æ–ª—å–∑—É—è ¬´–Ω–æ¬ª –∏–ª–∏ ¬´–æ–¥–Ω–∞–∫–æ¬ª.',
                locale: 'ru',
                task_type: 'sentence',
              },
              {
                id: uuidv4(),
                description: '–ü–µ—Ä–µ—á–∏—Å–ª–∏—Ç–µ —Ç—Ä–∏ —Å–∏–Ω–æ–Ω–∏–º–∞ –∏–ª–∏ —Å–ª–æ–≤–æ—Å–æ—á–µ—Ç–∞–Ω–∏—è, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–æ–º –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏.',
                locale: 'ru',
                task_type: 'sentence',
              },
              {
                id: uuidv4(),
                description: '–ù–∞–ø–∏—à–∏—Ç–µ —Å–ª–µ–¥—É—é—â–µ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –ª–æ–≥–∏—á–µ—Å–∫–∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Å–∏—Ç—É–∞—Ü–∏—é.',
                locale: 'ru',
                task_type: 'sentence',
              },
              {
                id: uuidv4(),
                description: '–û–±—ä—è—Å–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ —Å–ª–æ–≤–∞ –∏–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –≤ –º–∏–Ω–∏-—É—Ä–æ–∫–µ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é 15 —Å–µ–∫—É–Ω–¥.',
                locale: 'ru',
                task_type: 'sentence',
              },
              {
                id: uuidv4(),
                description: '–ó–∞–¥–∞–π—Ç–µ —Ç—Ä–∏ –±—ã—Å—Ç—Ä—ã—Ö –≤–æ–ø—Ä–æ—Å–∞-–∏–Ω—Ç–µ—Ä–≤—å—é, –∫–æ—Ç–æ—Ä—ã–µ –∫—Ç–æ-—Ç–æ –º–æ–≥ –±—ã –∑–∞–¥–∞—Ç—å –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ —É—Å–ª—ã—à–∏—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ.',
                locale: 'ru',
                task_type: 'sentence',
              },
              {
                id: uuidv4(),
                description: '–ó–∞–¥–∞–π—Ç–µ –∫—Ä–∞—Ç–∫–∏–π –≤–æ–ø—Ä–æ—Å, –≤ –∫–æ—Ç–æ—Ä–æ–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ü–µ–ª–µ–≤–æ–µ —Å–ª–æ–≤–æ (¬´–ö–∞–∫–∞—è —É –≤–∞—Å –ª—é–±–∏–º–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å [—Å–ª–æ–≤–æ]?¬ª).',
                locale: 'ru',
                task_type: 'word',
              },
              {
                id: uuidv4(),
                description: '–î–∞–π—Ç–µ –∑–∞–¥–∞–Ω–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–ª–æ–≤–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: ¬´–ß—Ç–æ –ª—É—á—à–µ ‚Äì [—Å–ª–æ–≤–æ] –æ–¥–Ω–æ–º—É –∏–ª–∏ –≤ –≥—Ä—É–ø–ø–µ?¬ª).',
                locale: 'ru',
                task_type: 'word',
              },
              {
                id: uuidv4(),
                description: '–ù–∞–∑–æ–≤–∏—Ç–µ —Ç—Ä–∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã—Ö —Å–ª–æ–≤–æ—Å–æ—á–µ—Ç–∞–Ω–∏—è (—Å–ª–æ–≤–∞, —á–∞—Å—Ç–æ —Å–æ—á–µ—Ç–∞—é—â–∏–µ—Å—è) –¥–ª—è —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–≥–æ —Å–ª–æ–≤–∞.',
                locale: 'ru',
                task_type: 'word',
              },
              {
                id: uuidv4(),
                description: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏—Ç–≤–æ—Ä—è–µ—Ç—Å—è, —á—Ç–æ –ø—Ä–µ–ø–æ–¥–∞—ë—Ç —Å–ª–æ–≤–æ –¥—Ä—É–≥—É: –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –º–∏–Ω–∏-—É—Ä–æ–∫ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é 20 —Å–µ–∫—É–Ω–¥ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º —Å–ª–æ–≤–∞, –ø—Ä–∏–º–µ—Ä–æ–º –∏ –ø—Ä–æ–∏–∑–Ω–æ—à–µ–Ω–∏–µ–º.',
                locale: 'ru',
                task_type: 'word',
              },
              {
                id: uuidv4(),
                description: '–í –∫–æ–Ω—Ü–µ –¥–Ω—è –ø—Ä–µ–¥–ª–æ–∂–∏—Ç–µ ¬´–ö–∞–∫ –≤—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–µ —Å–ª–æ–≤–æ –≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è?¬ª –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç 60-—Å–µ–∫—É–Ω–¥–Ω–æ–µ –ª–∏—á–Ω–æ–µ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–µ, –∑–∞–∫—Ä–µ–ø–ª—è—è –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –≤ —Ä–µ–∞–ª—å–Ω–æ–π –∂–∏–∑–Ω–∏.',
                locale: 'ru',
                task_type: 'word',
              },
              {
                  id: uuidv4(),
                  description: 'Termina esta oraci√≥n de forma l√≥gica, usando la oraci√≥n modelo como contexto.',
                  locale: 'es',
                  task_type: 'sentence',
                },
                {
                  id: uuidv4(),
                  description: 'Parafrasea la oraci√≥n dada con tus propias palabras.',
                  locale: 'es',
                  task_type: 'sentence',
                },
                {
                  id: uuidv4(),
                  description: 'Haz una pregunta de seguimiento basada en el contenido de la oraci√≥n.',
                  locale: 'es',
                  task_type: 'sentence',
                },
                {
                  id: uuidv4(),
                  description: 'Responde tu propia pregunta relacionada con el contexto de la oraci√≥n.',
                  locale: 'es',
                  task_type: 'sentence',
                },
                {
                  id: uuidv4(),
                  description: 'Transforma la oraci√≥n a su forma negativa.',
                  locale: 'es',
                  task_type: 'sentence',
                },
                {
                  id: uuidv4(),
                  description: 'Cambia el tiempo de la oraci√≥n (por ejemplo, presente ‚Üí futuro).',
                  locale: 'es',
                  task_type: 'sentence',
                },
                {
                  id: uuidv4(),
                  description: 'Convierte la afirmaci√≥n en una pregunta de s√≠/no o en una pregunta con pronombre interrogativo.',
                  locale: 'es',
                  task_type: 'sentence',
                },
                {
                  id: uuidv4(),
                  description: 'Resume el significado de la oraci√≥n en una sola oraci√≥n m√°s breve.',
                  locale: 'es',
                  task_type: 'sentence',
                },
                {
                  id: uuidv4(),
                  description: 'Expande la oraci√≥n a√±adiendo dos detalles extra (hora, lugar o motivo).',
                  locale: 'es',
                  task_type: 'sentence',
                },
                {
                  id: uuidv4(),
                  description: 'Crea una oraci√≥n de contraste usando ‚Äúpero‚Äù o ‚Äúsin embargo‚Äù.',
                  locale: 'es',
                  task_type: 'sentence',
                },
                {
                  id: uuidv4(),
                  description: 'Enumera tres sin√≥nimos o colocaciones relacionadas con la palabra clave en la oraci√≥n.',
                  locale: 'es',
                  task_type: 'sentence',
                },
                {
                  id: uuidv4(),
                  description: 'Escribe una oraci√≥n de seguimiento que contin√∫e l√≥gicamente el escenario.',
                  locale: 'es',
                  task_type: 'sentence',
                },
                {
                  id: uuidv4(),
                  description: 'Explica el significado de una palabra de la oraci√≥n en una mini- lecci√≥n de 15 segundos.',
                  locale: 'es',
                  task_type: 'sentence',
                },
                {
                  id: uuidv4(),
                  description: 'Formula tres preguntas r√°pidas tipo entrevista que alguien podr√≠a hacer despu√©s de escuchar la oraci√≥n.',
                  locale: 'es',
                  task_type: 'sentence',
                },
                {
                  id: uuidv4(),
                  description: 'Formula una breve pregunta que enmarque la palabra objetivo (‚Äú¬øCu√°l es tu actividad favorita de [word]?‚Äù).',
                  locale: 'es',
                  task_type: 'word',
                },
                {
                  id: uuidv4(),
                  description: 'Presenta un enunciado que involucre la palabra (por ejemplo, ‚Äú¬øEs mejor [word] solo o en grupo?‚Äù).',
                  locale: 'es',
                  task_type: 'word',
                },
                {
                  id: uuidv4(),
                  description: 'Enumera tres colocaciones comunes (palabras que suelen ir juntas) para la palabra de hoy.',
                  locale: 'es',
                  task_type: 'word',
                },
                {
                  id: uuidv4(),
                  description: 'El usuario finge ense√±ar la palabra a un amigo: graba una mini lecci√≥n de 20 segundos definiendo la palabra, dando un ejemplo y pronunci√°ndola.',
                  locale: 'es',
                  task_type: 'word',
                },
                {
                  id: uuidv4(),
                  description: 'Al final del d√≠a, pregunta ‚Äú¬øC√≥mo usaste la palabra de hoy fuera de la aplicaci√≥n?‚Äù El usuario graba una reflexi√≥n personal de 60 segundos, consolidando la relevancia en el mundo real.',
                  locale: 'es',
                  task_type: 'word',
                }
        ];

    const insertSQL = `
          INSERT INTO tasks (
            id,
            description,
            locale,
            task_type
          ) VALUES (?, ?, ?, ?);
        `;
        const stmt = db.prepare(insertSQL);

        for (const task of tasks) {
          stmt.run(
            task.id,
            task.description,
            task.locale,
            task.task_type,
            (err) => {
              if (err) {
                console.error('‚ùå Failed to insert task:', task.id, err.message);
              }
            }
          );
        }

        stmt.finalize((err) => {
          if (err) return reject(err);
          console.log(`‚úÖ Inserted ${tasks.length} tasks into table "tasks"`);
          resolve();
        });
      });
    }

async function main() {
  const db = new sqlite3.Database(DB_PATH, sqlite3.OPEN_READWRITE, (err) => {
    if (err) {
      console.error(`‚ùå Unable to open database at ${DB_PATH}:`, err.message);
      process.exit(1);
    }
  });

  try {
    await new Promise((resolve) => db.serialize(resolve)); // Ensures serialize runs once
    await createTasksTable(db);
    await clearTasksTable(db);   // Clear ONCE
    await insertTasks(db);       // Fill ONCE
    console.log('üéâ All done.');
  } catch (e) {
    console.error('‚ùå Error:', e);
  } finally {
    db.close();
  }
}


main();
